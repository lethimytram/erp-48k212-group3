<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="paperformat_certificate_landscape" model="report.paperformat">
        <field name="name">Certificate Landscape A4</field>
        <field name="default" eval="True"/>
        <field name="format">A4</field>
        <field name="orientation">Landscape</field>
        <field name="margin_top">10</field>
        <field name="margin_bottom">10</field>
        <field name="margin_left">10</field>
        <field name="margin_right">10</field>
        <field name="header_line" eval="False"/>
        <field name="header_spacing">0</field>
        <field name="dpi">90</field>
    </record>

    <record id="action_report_training_certificate" model="ir.actions.report">
        <field name="name">Chứng chỉ đào tạo</field>
        <field name="model">training.certificate</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">training_management.report_training_certificate</field>
        <field name="report_file">training_management.report_training_certificate</field>
        <field name="print_report_name">'Certificate_%s' % (object.name)</field>
        <field name="binding_model_id" ref="model_training_certificate"/>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="paperformat_certificate_landscape"/>
    </record>

    <template id="report_training_certificate">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <div class="page" style="position: relative; width: 100%; height: 100%; font-family: 'Times New Roman', serif;">

                    <t t-if="o.certificate_html">
                        <div style="width: 100%; height: 100%;">
                            <t t-raw="o.certificate_html"/>
                        </div>
                    </t>

                    <t t-else="">
                        <div style="width: 100%; height: 95vh; border: 10px double #5d4037; padding: 40px; text-align: center; box-sizing: border-box; background-color: #fffcf5; position: relative;">

                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0.05; z-index: 0;">
                                <img t-if="o.company_id.logo" t-att-src="image_data_uri(o.company_id.logo)" style="width: 500px;"/>
                            </div>

                            <div style="position: relative; z-index: 1;">
                                <div style="margin-top: 20px;">
                                    <h1 style="font-size: 50px; color: #5d4037; text-transform: uppercase; letter-spacing: 5px; margin-bottom: 5px; font-weight: bold;">Chứng Nhận</h1>
                                    <p style="font-size: 24px; color: #b08d55; font-style: italic; margin-top: 0;">Certificate of Completion</p>
                                </div>

                                <div style="margin-top: 40px;">
                                    <p style="font-size: 18px; color: #555; margin-bottom: 10px;">Chứng nhận này được trân trọng trao cho</p>

                                    <h2 style="font-size: 45px; color: #000; margin: 15px 0; font-weight: bold; text-transform: uppercase; border-bottom: 1px solid #ddd; display: inline-block; padding-bottom: 10px; min-width: 400px;">
                                        <span t-field="o.employee_id.name"/>
                                    </h2>

                                    <p style="font-size: 18px; color: #555; margin-top: 20px;">Đã hoàn thành xuất sắc quy trình đào tạo</p>

                                    <h3 style="font-size: 35px; color: #b08d55; margin: 15px 0; font-weight: bold;">
                                        <span t-field="o.course_id.name"/>
                                    </h3>
                                </div>

                                <div style="margin-top: 30px; font-size: 16px; color: #333; display: flex; justify-content: center; align-items: center; gap: 40px;">
                                    <div>
                                        <span>Ngày cấp: </span>
                                        <strong>
                                            <span t-field="o.issue_date" t-options='{"widget": "date"}'/>
                                        </strong>
                                    </div>
                                    <div>|</div>
                                    <div>
                                        <span>Số hiệu: </span>
                                        <strong>
                                            <span t-field="o.name"/>
                                        </strong>
                                    </div>
                                    <div>|</div>
                                    <div>
                                        <span>Xếp loại: </span>
                                        <strong>
                                            <span t-if="o.grade == 'excellent'" style="color: #d32f2f;">Xuất sắc</span>
                                            <span t-if="o.grade == 'good'" style="color: #1976d2;">Giỏi</span>
                                            <span t-if="o.grade == 'average'">Khá</span>
                                            <span t-if="o.grade == 'pass'">Đạt</span>
                                        </strong>
                                    </div>
                                </div>

                                <div style="margin-top: 80px; display: flex; justify-content: space-between; padding: 0 100px;">
                                    <div style="text-align: center; width: 250px;">
                                        <div style="height: 60px;"></div>
                                        <div style="border-top: 2px solid #5d4037; margin: 10px auto; width: 80%;"></div>
                                        <p style="font-weight: bold; color: #5d4037; font-size: 16px; margin: 0;">Trưởng Bộ Phận Đào Tạo</p>
                                    </div>

                                    <div style="text-align: center; width: 250px;">
                                        <div style="height: 60px; display: flex; align-items: flex-end; justify-content: center;">
                                            <img t-if="o.signature" t-att-src="image_data_uri(o.signature)" style="max-height: 60px; max-width: 150px;"/>
                                        </div>
                                        <div style="border-top: 2px solid #5d4037; margin: 10px auto; width: 80%;"></div>
                                        <p style="font-weight: bold; color: #5d4037; font-size: 16px; margin: 0;">
                                            <span t-if="o.signed_by" t-field="o.signed_by.name"/>
                                            <br/>
                                            <span t-else="">Giám Đốc Vận Hành</span>
                                        </p>
                                    </div>
                                </div>

                                <div style="position: absolute; bottom: 20px; left: 0; width: 100%; text-align: center; font-size: 12px; color: #999;">
                                    <span t-field="o.company_id.name"/>
 | Hệ thống Đào tạo &amp; Phát triển Nguồn nhân lực
                                </div>
                            </div>
                        </div>
                    </t>
                </div>
            </t>
        </t>
    </template>
</odoo>