<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_training_feedback_tree" model="ir.ui.view">
        <field name="name">training.feedback.list</field>
        <field name="model">training.feedback</field>
        <field name="arch" type="xml">
            <list string="Khảo sát hài lòng" decoration-danger="overall_rating in ('1','2')" decoration-success="overall_rating == '5'">
                <field name="enrollment_id"/>
                <field name="course_id"/>
                <field name="employee_id" widget="many2one_avatar_user"/>
                <field name="feedback_date"/>
                <field name="overall_rating" widget="priority" readonly="1"/>
                <field name="state" widget="badge" decoration-success="state == 'submitted'"/>
            </list>
        </field>
    </record>

    <record id="view_training_feedback_form" model="ir.ui.view">
        <field name="name">training.feedback.form</field>
        <field name="model">training.feedback</field>
        <field name="arch" type="xml">
            <form string="Phiếu khảo sát">
                <header>
                    <button name="action_submit" string="Gửi đánh giá" type="object" class="oe_highlight" invisible="state != 'draft'"/>
                    <button name="action_cancel" string="Hủy" type="object" invisible="state != 'draft'"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,submitted"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="enrollment_id" options="{'no_create': True}" readonly="state != 'draft'" placeholder="Chọn khóa học cần đánh giá..."/>
                        </h1>
                    </div>

                    <group>
                        <group>
                            <field name="employee_id"/>
                            <field name="course_id"/>
                            <field name="trainer_id" readonly="state != 'draft'"/>
                        </group>
                        <group>
                            <field name="feedback_date"/>
                            <field name="company_id" invisible="1"/>
                        </group>
                    </group>

                    <separator string="Đánh giá chất lượng (1 sao = Tệ, 5 sao = Xuất sắc)"/>
                    <group>
                        <group>
                            <field name="overall_rating" widget="priority" readonly="state != 'draft'"/>
                            <field name="content_rating" widget="priority" readonly="state != 'draft'"/>
                            <field name="trainer_rating" widget="priority" readonly="state != 'draft'"/>
                        </group>
                        <group>
                            <field name="material_rating" widget="priority" readonly="state != 'draft'"/>
                            <field name="organization_rating" widget="priority" readonly="state != 'draft'"/>
                        </group>
                    </group>

                    <group string="Ý kiến đóng góp">
                        <field name="comments" placeholder="Bạn có điều gì chưa hài lòng không?..." nolabel="1" readonly="state != 'draft'"/>
                    </group>
                    <group string="Đề xuất cải tiến">
                        <field name="suggestions" placeholder="Chúng tôi nên làm gì để khóa học tốt hơn?..." nolabel="1" readonly="state != 'draft'"/>
                    </group>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <record id="view_training_feedback_search" model="ir.ui.view">
        <field name="name">training.feedback.search</field>
        <field name="model">training.feedback</field>
        <field name="arch" type="xml">
            <search>
                <field name="course_id"/>
                <field name="employee_id"/>
                <filter string="Đánh giá thấp (1-2 sao)" name="low_rating" domain="[('overall_rating', 'in', ['1', '2'])]"/>
                <filter string="Đánh giá cao (4-5 sao)" name="high_rating" domain="[('overall_rating', 'in', ['4', '5'])]"/>
                <group expand="0" string="Group By">
                    <filter string="Khóa học" name="group_course" context="{'group_by': 'course_id'}"/>
                    <filter string="Xếp loại" name="group_rating" context="{'group_by': 'overall_rating'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="action_training_feedback" model="ir.actions.act_window">
        <field name="name">Khảo sát &amp; Phản hồi</field>
        <field name="res_model">training.feedback</field>
        <field name="view_mode">list,form</field>
        <field name="context">{'search_default_group_course': 1}</field>
    </record>

</odoo>